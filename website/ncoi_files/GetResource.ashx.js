(function(n){var t,i;if(n){function r(t,i){var r=this;r.Checked=n.observable(t.Checked),r.Classes=n.observable(t.Classes),r.Count=n.observable(t.Count),r.DisplayTerm=n.observable(t.DisplayTerm),r.Enabled=n.observable(t.Enabled),r.SortTerm=n.observable(t.SortTerm),r.Term=n.observable(t.Term),r.ClickOnLabel=function(){r.Enabled()&&(r.Classes().indexOf("selected")>-1?(r.Checked(!1),r.Classes(r.Classes().replace(" selected",""))):(r.Checked(!0),r.Classes(r.Classes()+" selected")),i.currentstep()==4&&i.GetTotal())}}function f(i,u,f){var e=this;e.currentfacetheader=n.observable(""),e.currentstep=n.observable(1),e.error=n.observable(!1),e.facetValues=n.observableArray([]),e.facetValues1=n.observableArray([]),e.facetValues2=n.observableArray([]),e.facetValues3=n.observableArray([]),e.firststep=n.observable(1),e.ie8=$("body").hasClass("IE8"),e.laststep=n.observable(4),e.loading=n.observable(!1),e.resultbuttontext=u,e.resultbuttonurl=f,e.steps=n.observableArray(i),e.total=n.observable(0),e.total.extend({notify:"always"}),e.ClickOnCheckbox=function(n,t){var u,f,i,r;n.Classes.indexOf("selected")>-1?(n.Checked=!1,n.Classes=n.Classes.replace(" selected","")):(n.Checked=!0,n.Classes=n.Classes+" selected"),u=$(t.target).parents(),u.each(function(){if(this.id.indexOf("facetValues")!==-1)return f=$(this)}),i=f.attr("id"),r=e[i].splice(0,e[i]().length),e[i](r),e.currentstep()==4&&e.GetTotal()},e.GetFacetValues=function(){function i(){e.loading(!0),$.ajax({method:"POST",url:"/CMSPages/WebService.asmx/GetCourseWizardFacets",data:n.toJSON({steps:e.steps()}),contentType:"application/json",dataType:"json",success:function(i){var f,u;i.d.FacetValues.length>0?(e.ie8?(f=Math.floor(i.d.FacetValues.length/3),i.d.FacetValues.length%3>0&&f++,e.facetValues1([]),u=i.d.FacetValues.slice(0,f),n.utils.arrayForEach(u,function(n){e.facetValues1.push(new r(n,e))}),e.facetValues2([]),u=i.d.FacetValues.slice(f,2*f),n.utils.arrayForEach(u,function(n){e.facetValues2.push(new r(n,e))}),e.facetValues3([]),u=i.d.FacetValues.slice(2*f,i.d.FacetValues.length),n.utils.arrayForEach(u,function(n){e.facetValues3.push(new r(n,e))})):(e.facetValues([]),n.utils.arrayForEach(i.d.FacetValues,function(n){e.facetValues.push(new r(n,e))})),e.total(i.d.Total)):e.error(!0),e.loading(!1),t.fadeOut({duration:200})},error:function(){e.loading(!1),e.error(!0),t.fadeOut({duration:200})}})}var t=$(".busy-wizzy");t.fadeIn({duration:200,done:i})},e.GetTotal=function(){e.steps()[e.currentstep()-1].SelectedFacets="",$("div.wizard-wrapper ul.options input").each(function(n,t){$(t).is(":checked")&&(e.steps()[e.currentstep()-1].SelectedFacets=e.steps()[e.currentstep()-1].SelectedFacets==""?$(t).val():e.steps()[e.currentstep()-1].SelectedFacets+","+$(t).val())}),$.ajax({method:"POST",url:"/CMSPages/WebService.asmx/GetCourseWizardTotal",data:n.toJSON({steps:e.steps()}),contentType:"application/json",dataType:"json",success:function(n){e.total(n.d)}})},e.GoToStep=function(n,t){var i;if(e.steps()[e.currentstep()-1].StepSkipped=!1,e.steps()[e.currentstep()-1].SelectedFacets="",n>e.currentstep())if(t)for(i=0;i<e.steps().length;i++)i==e.currentstep()-1&&(e.steps()[i].StepSkipped=!0);else $("div.wizard-wrapper ul.options input").each(function(n,t){$(t).is(":checked")&&(e.steps()[e.currentstep()-1].SelectedFacets=e.steps()[e.currentstep()-1].SelectedFacets==""?$(t).val():e.steps()[e.currentstep()-1].SelectedFacets+","+$(t).val())});for(e.currentstep(n),i=0;i<e.steps().length;i++)e.steps()[i].CurrentFacet=i==e.currentstep()-1?!0:!1;e.GetFacetValues()},e.checkLineHeight=function(n){var t=$(n).filter("li");t.height()>47&&t.addClass("smaller-text")},e.NextButtonClass=n.pureComputed(function(){return t.currentstep()==1?"firstStep":""}),e.ResultButtonText=n.pureComputed(function(){return t.total()>=0?t.resultbuttontext+" (<span>"+t.total()+"</span>)":""}),e.ResultButtonUrl=n.pureComputed(function(){var u=e.total(),i="",n,r,t;if(e.currentstep()==e.laststep())for(n=0;n<e.steps().length;n++)if(e.steps()[n].SelectedFacets!="")for(r=e.steps()[n].SelectedFacets.split(","),t=0;t<r.length;t++)i=i==""?encodeURIComponent("facets["+e.steps()[n].FacetName+"][]="+r[t]):i+"&"+encodeURIComponent("facets["+e.steps()[n].FacetName+"][]="+r[t]);return e.resultbuttonurl+"?"+i})}n.bindingHandlers.fadeVisible={init:function(t,i){var r=i();$(t).toggle(n.unwrap(r))},update:function(t,i){var r=i();n.unwrap(r)?$(t).fadeIn():$(t).fadeOut()}},t=new f(_steps,_resultButtonText,_resultButtonUrl),n.applyBindings(t),i=document.querySelector("#facetValues");function e(){var n=$(i).find(".not-visible");n.length&&n.remove()}function u(){var n=i.querySelectorAll("li").length;$(i)[n===3?"addClass":"removeClass"]("column-fix"),n%3!=0&&($(i).append('<li class="not-visible"><label><input type="checkbox"><span></span></label></li>'),u())}t.loading.subscribe(function(n){n||(t.currentfacetheader(t.steps()[t.currentstep()-1].Header),$(".IE8").length||(e(),u()))}),t.GoToStep(1)}})(window.ko)