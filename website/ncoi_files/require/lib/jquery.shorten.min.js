/*!*
-------------------------------
Jquery shorten
-------------------------------
https://github.com/viralpatel/jquery.shorten
-------------------------------
**/
 define(["jquery"], function (jQuery) {

!function (e) { e.fn.shorten = function (s) { "use strict"; var t = { showChars: 100, ellipsesText: "...", moreText: "more", lessText: "less", errMsg: null, force: !1 }; return s && e.extend(t, s), e(this).data("jquery.shorten") && !t.force ? !1 : (e(this).data("jquery.shorten", !0), e(document).off("click", ".morelink"), e(document).on({ click: function () { var s = e(this); return s.hasClass("less") ? (s.removeClass("less"), s.html(t.moreText), s.parent().prev().prev().show(), s.parent().prev().hide()) : (s.addClass("less"), s.html(t.lessText), s.parent().prev().prev().hide(), s.parent().prev().show()), !1 } }, ".morelink"), this.each(function () { var s = e(this), r = s.html(), n = s.text().length; if (n > t.showChars) { var l = r.substr(0, t.showChars); if (l.indexOf("<") >= 0) { for (var a = !1, h = "", o = 0, i = [], c = null, f = 0, p = 0; p <= t.showChars; f++) if ("<" != r[f] || a || (a = !0, c = r.substring(f + 1, r.indexOf(">", f)), "/" == c[0] ? c != "/" + i[0] ? t.errMsg = "ERROR en HTML: the top of the stack should be the tag that closes" : i.shift() : "br" != c.toLowerCase() && i.unshift(c)), a && ">" == r[f] && (a = !1), a) h += r.charAt(f); else if (p++, o <= t.showChars) h += r.charAt(f), o++; else if (i.length > 0) { for (j = 0; j < i.length; j++) h += "</" + i[j] + ">"; break } l = e("<div/>").html(h + '<span class="ellip">' + t.ellipsesText + "</span>").html() } else l += t.ellipsesText; var d = '<div class="shortcontent">' + l + '</div><div class="allcontent">' + r + '</div><span><a href="javascript://nop/" class="morelink">' + t.moreText + "</a></span>"; s.html(d), s.find(".allcontent").hide(), e(".shortcontent p:last", s).css("margin-bottom", 0) } })) } }(jQuery);

 });

